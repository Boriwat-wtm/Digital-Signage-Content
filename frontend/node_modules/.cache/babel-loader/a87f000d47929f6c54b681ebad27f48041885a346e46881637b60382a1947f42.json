{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\pyaks\\\\CMS\\\\Digital-Singnage-CMS-main\\\\frontend\\\\src\\\\Register.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport \"./Register.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Register() {\n  _s();\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\n  const [otp, setOtp] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [isOtpSent, setIsOtpSent] = useState(false);\n  const [token, setToken] = useState(\"\");\n  const navigate = useNavigate();\n  const otpRefs = useRef([]);\n  const sendOtp = async () => {\n    try {\n      const response = await fetch(\"http://localhost:5000/send-otp\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          phoneNumber\n        })\n      });\n      const data = await response.json();\n      if (response.ok && data.success) {\n        alert(\"ส่ง OTP สำเร็จ!\");\n        setToken(data.token); // เก็บ token ที่ได้รับจาก backend\n        setIsOtpSent(true);\n      } else {\n        setErrorMessage(data.message || \"ไม่สามารถส่ง OTP ได้\");\n      }\n    } catch (error) {\n      console.error(\"Error during OTP request:\", error);\n      setErrorMessage(\"เกิดข้อผิดพลาดในการส่ง OTP\");\n    }\n  };\n  const verifyOtp = async () => {\n    try {\n      const response = await fetch(\"http://localhost:5000/verify-otp\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          otp,\n          token\n        })\n      });\n      const data = await response.json();\n      if (response.ok && data.success) {\n        alert(\"เข้าสู่ระบบสำเร็จ!\");\n        navigate(\"/home\"); // เปลี่ยนไปยังหน้า Home\n      } else {\n        setErrorMessage(data.message || \"OTP ไม่ถูกต้อง\");\n      }\n    } catch (error) {\n      console.error(\"Error during OTP verification:\", error);\n      setErrorMessage(\"เกิดข้อผิดพลาดในการยืนยัน OTP\");\n    }\n  };\n  const handleOtpChange = (index, value) => {\n    const otpArray = otp.split(\"\");\n    otpArray[index] = value;\n    setOtp(otpArray.join(\"\"));\n    if (value && index < otpRefs.current.length - 1) {\n      otpRefs.current[index + 1].focus();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"register-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"User Login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), !isOtpSent ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"register-form\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"phoneNumber\",\n        children: \"Phone Number\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"phoneNumber\",\n        value: phoneNumber,\n        onChange: e => setPhoneNumber(e.target.value),\n        placeholder: \"\\u0E01\\u0E23\\u0E2D\\u0E01\\u0E40\\u0E1A\\u0E2D\\u0E23\\u0E4C\\u0E42\\u0E17\\u0E23\\u0E28\\u0E31\\u0E1E\\u0E17\\u0E4C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error-message\",\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 28\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: sendOtp,\n        children: \"\\u0E02\\u0E2D\\u0E23\\u0E2B\\u0E31\\u0E2A OTP\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"otp-form\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"\\u0E01\\u0E23\\u0E2D\\u0E01\\u0E23\\u0E2B\\u0E31\\u0E2A OTP\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"otp-inputs\",\n        children: [...Array(6)].map((_, index) => /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          maxLength: \"1\",\n          ref: el => otpRefs.current[index] = el,\n          onChange: e => handleOtpChange(index, e.target.value)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error-message\",\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 28\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: verifyOtp,\n        children: \"\\u0E22\\u0E37\\u0E19\\u0E22\\u0E31\\u0E19 OTP\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n}\n_s(Register, \"NSQdXJYfNl2mcAfXyIBSD6caG/U=\", false, function () {\n  return [useNavigate];\n});\n_c = Register;\nexport default Register;\nvar _c;\n$RefreshReg$(_c, \"Register\");","map":{"version":3,"names":["React","useState","useRef","useNavigate","jsxDEV","_jsxDEV","Register","_s","phoneNumber","setPhoneNumber","otp","setOtp","errorMessage","setErrorMessage","isOtpSent","setIsOtpSent","token","setToken","navigate","otpRefs","sendOtp","response","fetch","method","headers","body","JSON","stringify","data","json","ok","success","alert","message","error","console","verifyOtp","handleOtpChange","index","value","otpArray","split","join","current","length","focus","className","children","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","type","id","onChange","e","target","placeholder","onClick","Array","map","_","maxLength","ref","el","_c","$RefreshReg$"],"sources":["C:/Users/pyaks/CMS/Digital-Singnage-CMS-main/frontend/src/Register.js"],"sourcesContent":["import React, { useState, useRef } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport \"./Register.css\";\r\n\r\nfunction Register() {\r\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\r\n  const [otp, setOtp] = useState(\"\");\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const [isOtpSent, setIsOtpSent] = useState(false);\r\n  const [token, setToken] = useState(\"\");\r\n  const navigate = useNavigate();\r\n  const otpRefs = useRef([]);\r\n\r\n  const sendOtp = async () => {\r\n    try {\r\n      const response = await fetch(\"http://localhost:5000/send-otp\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ phoneNumber }),\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (response.ok && data.success) {\r\n        alert(\"ส่ง OTP สำเร็จ!\");\r\n        setToken(data.token); // เก็บ token ที่ได้รับจาก backend\r\n        setIsOtpSent(true);\r\n      } else {\r\n        setErrorMessage(data.message || \"ไม่สามารถส่ง OTP ได้\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error during OTP request:\", error);\r\n      setErrorMessage(\"เกิดข้อผิดพลาดในการส่ง OTP\");\r\n    }\r\n  };\r\n\r\n  const verifyOtp = async () => {\r\n    try {\r\n      const response = await fetch(\"http://localhost:5000/verify-otp\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ otp, token }),\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (response.ok && data.success) {\r\n        alert(\"เข้าสู่ระบบสำเร็จ!\");\r\n        navigate(\"/home\"); // เปลี่ยนไปยังหน้า Home\r\n      } else {\r\n        setErrorMessage(data.message || \"OTP ไม่ถูกต้อง\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error during OTP verification:\", error);\r\n      setErrorMessage(\"เกิดข้อผิดพลาดในการยืนยัน OTP\");\r\n    }\r\n  };\r\n\r\n  const handleOtpChange = (index, value) => {\r\n    const otpArray = otp.split(\"\");\r\n    otpArray[index] = value;\r\n    setOtp(otpArray.join(\"\"));\r\n    if (value && index < otpRefs.current.length - 1) {\r\n      otpRefs.current[index + 1].focus();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"register-container\">\r\n      <h1>User Login</h1>\r\n      {!isOtpSent ? (\r\n        <div className=\"register-form\">\r\n          <label htmlFor=\"phoneNumber\">Phone Number</label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"phoneNumber\"\r\n            value={phoneNumber}\r\n            onChange={(e) => setPhoneNumber(e.target.value)}\r\n            placeholder=\"กรอกเบอร์โทรศัพท์\"\r\n          />\r\n          {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\r\n          <button onClick={sendOtp}>ขอรหัส OTP</button>\r\n        </div>\r\n      ) : (\r\n        <div className=\"otp-form\">\r\n          <label>กรอกรหัส OTP</label>\r\n          <div className=\"otp-inputs\">\r\n            {[...Array(6)].map((_, index) => (\r\n              <input\r\n                key={index}\r\n                type=\"text\"\r\n                maxLength=\"1\"\r\n                ref={(el) => (otpRefs.current[index] = el)}\r\n                onChange={(e) => handleOtpChange(index, e.target.value)}\r\n              />\r\n            ))}\r\n          </div>\r\n          {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\r\n          <button onClick={verifyOtp}>ยืนยัน OTP</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Register;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}